-- MH STEAL CHARACTER (BETA STABLE)
-- Visual Only | Sem copiar animações (anti-bug)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

if player.PlayerGui:FindFirstChild("MH_StealUI") then
	player.PlayerGui.MH_StealUI:Destroy()
end

-- GUI
local gui = Instance.new("ScreenGui", player.PlayerGui)
gui.Name = "MH_StealUI"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0,260,0,155)
frame.Position = UDim2.new(0.5,-130,0.4,0)
frame.BackgroundColor3 = Color3.fromRGB(30,30,40)
frame.Active = true
frame.Draggable = true
Instance.new("UICorner", frame).CornerRadius = UDim.new(0,10)

local stroke = Instance.new("UIStroke", frame)
stroke.Thickness = 2
RunService.RenderStepped:Connect(function()
	stroke.Color = Color3.fromHSV((tick()%5)/5,1,1)
end)

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1,0,0,28)
title.Text = "MH Steal Character"
title.Font = Enum.Font.GothamBold
title.TextSize = 14
title.TextColor3 = Color3.new(1,1,1)
title.BackgroundColor3 = Color3.fromRGB(40,40,55)
Instance.new("UICorner", title).CornerRadius = UDim.new(0,10)

local box = Instance.new("TextBox", frame)
box.Position = UDim2.new(0,10,0,50)
box.Size = UDim2.new(1,-20,0,30)
box.PlaceholderText = "Username"
box.ClearTextOnFocus = false
box.BackgroundColor3 = Color3.fromRGB(45,45,60)
box.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", box).CornerRadius = UDim.new(0,8)

local btn = Instance.new("TextButton", frame)
btn.Position = UDim2.new(0,10,0,90)
btn.Size = UDim2.new(1,-20,0,32)
btn.Text = "Steal Skin"
btn.Font = Enum.Font.GothamBold
btn.TextSize = 14
btn.BackgroundColor3 = Color3.fromRGB(70,120,255)
btn.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)

local status = Instance.new("TextLabel", frame)
status.Position = UDim2.new(0,10,0,128)
status.Size = UDim2.new(1,-20,0,18)
status.BackgroundTransparency = 1
status.TextColor3 = Color3.fromRGB(150,255,150)
status.TextXAlignment = Enum.TextXAlignment.Left
status.Font = Enum.Font.Gotham
status.TextSize = 12

-- CORE
local clone, welds = nil, {}

local function clear()
	if clone then clone:Destroy() end
	for _,w in pairs(welds) do w:Destroy() end
	welds = {}

	local char = player.Character
	if char then
		for _,p in pairs(char:GetDescendants()) do
			if p:IsA("BasePart") then
				p.LocalTransparencyModifier = 0
			end
		end
	end
end

local function steal(username)
	clear()
	status.Text = "Copying skin..."

	local ok,id = pcall(function()
		return Players:GetUserIdFromNameAsync(username)
	end)
	if not ok then
		status.Text = "User not found"
		return
	end

	local ok2,model = pcall(function()
		return Players:CreateHumanoidModelFromUserId(id)
	end)
	if not ok2 then
		status.Text = "Failed to load avatar"
		return
	end

	model.Parent = workspace
	model.Name = "MH_VisualClone"
	clone = model

	local char = player.Character or player.CharacterAdded:Wait()

	-- remove humanoid do clone
	local h = model:FindFirstChildOfClass("Humanoid")
	if h then h:Destroy() end

	-- esconder corpo original
	for _,p in pairs(char:GetDescendants()) do
		if p:IsA("BasePart") then
			p.LocalTransparencyModifier = 1
		end
	end

	-- soldar clone
	for _,p in pairs(model:GetDescendants()) do
		if p:IsA("BasePart") then
			p.CanCollide = false
			local o = char:FindFirstChild(p.Name)
			if o then
				p.CFrame = o.CFrame
				local w = Instance.new("WeldConstraint", p)
				w.Part0 = p
				w.Part1 = o
				table.insert(welds, w)
			end
		end
	end

	status.Text = "Skin aplicada (estável)"
end

btn.MouseButton1Click:Connect(function()
	if box.Text ~= "" then
		steal(box.Text)
	end
end)
